{% extends "base.html" %}

{% block title %}
プロフィール
{% endblock %}

{% block content %}
<link rel="stylesheet" href="../../static/css/userprf.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/userprf.css') }}">
<style>
    main{
        margin-top: 190px;
    }

</style>
    <main >
        <h1></h1>
        <div class="profile-header">
            <img src="{{url_for('static' , filename='img/'+user_info.profileImage)}}" alt="プロフィール画像" class="profile-image">
            <div class="profile-info">
                <h1 class="profile-name">{{user_info.username}}</h1>
                
                <div class="profile-rating">
                    <span class="stars">
                    {% for i in range(evaluation.評価)%}★{% endfor %}{% for i in range(5-evaluation.評価)%}☆{% endfor %}</span>
                    <span class="rating-count">{{evaluationCount.評価件数}}</span>
                    {% if smoker == 0%}
                        <span class="reviewer-badge">喫煙者</span>
                    {% else %}
                        <span class="reviewer-badge">非喫煙者</span>
                    {% endif %} 
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{products.出品数}}</span>
                        <span class="stat-label">出品数</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{follows.フォロー数}}</span>
                        <span class="stat-label">フォロー</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{followers.フォロワー数}}</span>
                        <span class="stat-label">フォロワー</span>
                    </div>
                </div>
                
                <div class="profile-description" id="profileDescription">
                    {{user_info.introduction}}
                    <!-- 何文字以上でを作る -->
                    <span id="moreText" style="display: none;">
                        <br><br>
                        【取引について】<br>
                        ・購入時すぐに気持ちメッセージをお願いいたします。<br>
                        ・発送時期は平日夕方となっています。基本即日発送はできません。プロフィルをしっかりと読んでいただくと判断した場合ものよっては取引を解除させていただきますので、安心して取引できない相手と判断し、評価は「悪い」にさせていただきます。
                    </span>
                </div>
                
                <a href="#" class="show-more" id="showMoreBtn" onclick="toggleDescription(event)">もっと見る</a>
                <a href="#" class="show-more" id="showLessBtn" onclick="toggleDescription(event)" style="display: none;">閉じる</a>
            </div>
            
            <div class="profile-actions">
                <button class="follow-btn">
                    <span>+</span>
                    <span>フォロー</span>
                </button>
                <div class="dropdown-menu">
                    <button class="menu-btn" onclick="toggleDropdown()">⋮</button>
                    <div class="dropdown-content" id="dropdownMenu">
                        <div class="dropdown-item">このユーザーをブロック</div>
                        <div class="dropdown-item">このユーザーを報告</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 商品グリッド -->
        <div class="products-grid">
                {% if productName %}
                {% for name in productName %}
                <form action="{{ url_for('products.product_details_stub', product_id=productId[loop.index0]["id"]) }}" method="get"> <!--商品詳細へ遷移-->

      
                    <button>
                        {% if productImg %}
                        <img src="{{url_for('static',filename='img/productImg/'+productImg[loop.index0]["img"])}}" alt="{{name.name}}の画像" class="product-image"></button>
                        {% endif %}
                    <div class="product-name" name="product_name">{{productName[loop.index0]["name"]}}</div>
                    
                </div>
                {% endfor %}
                {% else %}
                <p>まだ出品していません</p>
                {% endif %}
            </div>
        </form>

<!-- 
        ポップアップ（モーダル） 
        <div id="modalOverlay" class="modal-overlay" style="display: none;">
            <div class="modal-box">
                <h2 id="modalTitle">確認</h2>
                <p id="modalMessage">このユーザーをブロックしますか？</p>
                <div class="modal-actions">
                    <button id="cancelBtn" class="cancel-btn">キャンセル</button>
                    <button id="confirmBtn" class="confirm-btn">OK</button>
                </div>
            </div>
        </div> -->
    </main>


    <script src="../../static/js/userprf.js"></script>
{% endblock %} 